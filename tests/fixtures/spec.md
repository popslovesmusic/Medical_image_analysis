# Module Specification

**Path:** tests/fixtures
**Generated by:** Codex cleanup task
**Date:** 2025-10-31

Specification: Test Fixtures & Synthetic Data

Module Path: tests/fixtures/
Parent Specs:

tests/spec.md (Unified Testing Framework)

core/tensor/spec.md (tensor structures)

core/diagnostics/spec.md (metric verification)

trainer/spec.md (data loaders and preprocessors)

I. Mission

The Fixtures Subsystem provides reproducible, precomputed, and version-controlled data used for testing and validation.

Its primary objectives are:

Determinism — identical values across platforms and runs.

Isolation — fixtures never depend on live or external data.

Traceability — every fixture includes metadata linking it to the originating seed, algorithm, and commit hash.

Coverage — supports all test levels (unit, integration, regression, performance).

II. Directory Layout
tests/fixtures/
├─ chromatic/           # RGB/ChromaticTensor mock data
├─ spectral/            # Frequency-domain SpectralTensor data
├─ diagnostics/         # Baseline metric samples
├─ trainer/             # Miniature model checkpoints and mock weights
├─ configs/             # JSON/YAML experiment configurations
├─ temporal/            # Time-series trend data
├─ archives/            # Archived test baselines (SHA-locked)
└─ generator_scripts/   # Tools for fixture creation

III. Fixture Types
Type	Format	Description
Chromatic Fixtures	.npy, .pkl	Synthetic RGB tensors for color-space tests
Spectral Fixtures	.npy, .csv	Gaussian frequency profiles for sound mapping tests
Diagnostic Fixtures	.json, .csv	Known reference metrics for diagnostics validation
Trainer Fixtures	.pt, .onnx	Minimal model weights/checkpoints for learner validation
Config Fixtures	.yaml, .json	Small, deterministic config sets for trainer and dreamer
Temporal Fixtures	.npy	Sampled sine/cosine trends for continuity module
Archive Fixtures	.zip, .tar	Frozen test snapshots (used in regression)
IV. Deterministic Generation Protocol

Fixtures are generated via:

python tests/fixtures/generator_scripts/generate_all_fixtures.py


This script performs the following steps:

Step	Action	Constraint
1	Initialize global RNGs	random.seed(42), np.random.seed(42), torch.manual_seed(42)
2	Generate tensors using deterministic functions only	No external libraries with nondeterministic kernels
3	Normalize data to fixed floating precision	float32, round to 1e⁻⁶
4	Serialize to disk	Sorted, UTF-8, compressed
5	Generate SHA-256 hash	Stored in fixture manifest
6	Verify round-trip integrity	Load → Compare hash → Pass threshold (Δ < 1e⁻⁸)
V. Example Fixture Metadata

Each fixture has a corresponding .meta.json file storing full provenance data:

{
  "fixture_name": "mock_chromatic_tensor_001.npy",
  "type": "chromatic",
  "generator": "generate_chromatic_fixtures.py",
  "created": "2025-11-01T16:22:00Z",
  "seed": 42,
  "hash": "a81b9fd52c0d7a8b77f74c...",
  "dimensions": [64, 64, 3],
  "dtype": "float32",
  "mean_rgb": [0.501, 0.497, 0.499],
  "variance": 0.0012
}


This metadata is validated automatically before any test using it executes.

VI. Standard Fixture Examples
1. Chromatic Tensor Fixture

File: chromatic/mock_tensor_001.npy
Shape: (64, 64, 3)
Description: Random RGB tensor with controlled noise.
Use: Tensor normalization and bridge tests.
Hash: 8b4f41d6e...

2. Spectral Tensor Fixture

File: spectral/mock_spectrum_01.npy
Shape: (256,)
Description: Gaussian kernel test spectrum centered at 440 Hz.
Use: Color ↔ Frequency reversibility tests.
Peak Frequency: 440.0 Hz

3. Diagnostic Fixture

File: diagnostics/metrics_baseline.json
Description: Reference accuracy/loss values for learner validation.

{"accuracy": 0.9001, "loss": 0.1054, "epoch": 15}

4. Config Fixture

File: configs/mock_trainer_config.yaml
Contents:

learning_rate: 0.001
batch_size: 4
epochs: 5
optimizer: adam

VII. Verification Workflow
Step	Script	Output
Verify metadata completeness	validate_fixture_metadata.py	JSON report
Recompute hash	verify_fixture_hashes.py	✅ / ❌
Round-trip load	verify_roundtrip_integrity.py	Δ < 1e⁻⁸
Cross-platform consistency	compare_fixtures_across_envs.py	Summary table
Archive snapshot	create_fixture_archive.py	fixtures_snapshot_<date>.zip

All verification results are logged to tests/logs/fixtures_validation.log.

VIII. Integration With Tests

Fixtures are automatically imported into unit and integration tests using deterministic discovery:

from tests.fixtures.loader import load_fixture
tensor = load_fixture("chromatic/mock_tensor_001.npy")


The loader:

Validates metadata hash before returning.

Logs fixture usage to tests/logs/fixture_usage.json.

Throws a FixtureIntegrityError if tampering is detected.

IX. Maintenance Rules
Rule	Description
No dynamic fixture creation in tests	Only pre-generated files are allowed
Regeneration requires commit bump	Each regeneration tagged via Git
Changes must be reviewed	Codex Validation Agent approval required
Old fixtures archived	Moved to /fixtures/archives/ with metadata
Hashes must match	CI blocks merge if hash mismatch occurs
X. Compliance Rules
Property	Constraint
File Format	.npy, .json, .yaml, .csv, .pt
Encoding	UTF-8
Compression	Optional (.gz)
Floating Precision	float32
RNG Seed	42
Hash Algorithm	SHA-256
Path Naming	lowercase_with_underscores
Metadata Field	Required for all fixtures
Version Tag	Embedded in .meta.json
XI. Compliance Summary
Field	Specification
Spec Version	1.0
Determinism Level	Bit-Exact
Fixture Count	Variable, auto-discovered
Hash Tolerance	Δ < 1e⁻⁸
Audit Authority	Codex Fixture Agent
Revision	{{auto-date}}
Status	✅ Verified Deterministic Fixture Store